
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Computing Functions Across a Rolling Window of Time &#8212; nengolib 0.5.0 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Research" href="../../notebooks.research.html" />
    <link rel="prev" title="Network Improvements" href="network.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Computing-Functions-Across-a-Rolling-Window-of-Time">
<h1>Computing Functions Across a Rolling Window of Time<a class="headerlink" href="#Computing-Functions-Across-a-Rolling-Window-of-Time" title="Permalink to this headline">¶</a></h1>
<p>The following notebook demonstrates use of the <code class="docutils literal"><span class="pre">RollingWindow</span></code> network, which is a wrapper around <code class="docutils literal"><span class="pre">LinearNetwork</span></code> that sets <code class="docutils literal"><span class="pre">sys=PadeDelay(theta,</span> <span class="pre">order=dimensions)</span></code> and uses a few extra formulas / tricks. This network allows one to compute nonlinear functions over a finite rolling window of input history. It is most accurate for low-frequency inputs and for low-order nonlinearities. See [1] for details.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">pylab</span> inline
<span class="kn">import</span> <span class="nn">pylab</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>  <span class="c1"># optional; prettier graphs</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">nengo</span>
<span class="kn">import</span> <span class="nn">nengolib</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Populating the interactive namespace from numpy and matplotlib
</pre></div></div>
</div>
<div class="section" id="1.-Setting-up-the-network">
<h2>1. Setting up the network<a class="headerlink" href="#1.-Setting-up-the-network" title="Permalink to this headline">¶</a></h2>
<p>We first create a <code class="docutils literal"><span class="pre">RollingWindow</span></code> network with <span class="math">\(\theta=0.1\,s\)</span> corresponding to the size of the window in seconds, and pick some number of <code class="docutils literal"><span class="pre">LIFRate</span></code> neurons (<code class="docutils literal"><span class="pre">2000</span></code>). The order of the approximation (the dimension of the network’s state ensemble) defaults to 6, since this was found to give the best fit to neural “time cell” data in rodents.</p>
<p>We also need to create an input stimulus. Here, we use a band-limited white noise <code class="docutils literal"><span class="pre">process</span></code> since these methods are optimal for low-frequency inputs. Next, connect this to the <code class="docutils literal"><span class="pre">input</span></code> node within the rolling window network.</p>
<p>Additionally, we provide this <code class="docutils literal"><span class="pre">process</span></code> to the network’s constructor to optimize its evaluation points and encoders (during the build phase) for this particular process. Note that we do <em>not</em> fix the seed of the process in order to prevent overfitting, but we do make the process long enough (<code class="docutils literal"><span class="pre">10</span></code> seconds) for it to generalize. This step is optional, but can dramatically improve the performance. If <code class="docutils literal"><span class="pre">process=None</span></code> the input should ideally be modelled, or the <code class="docutils literal"><span class="pre">eval_points</span></code>, (orthogonal)
<code class="docutils literal"><span class="pre">encoders</span></code>, and <code class="docutils literal"><span class="pre">radii</span></code> should be manually specified.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">process</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">processes</span><span class="o">.</span><span class="n">WhiteSignal</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">neuron_type</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">LIFRate</span><span class="p">()</span>  <span class="c1"># try out LIF() or Direct()</span>

<span class="k">with</span> <span class="n">nengolib</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">rw</span> <span class="o">=</span> <span class="n">nengolib</span><span class="o">.</span><span class="n">networks</span><span class="o">.</span><span class="n">RollingWindow</span><span class="p">(</span>
        <span class="n">theta</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n_neurons</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">process</span><span class="o">=</span><span class="n">process</span><span class="p">,</span> <span class="n">neuron_type</span><span class="o">=</span><span class="n">neuron_type</span><span class="p">)</span>

    <span class="n">stim</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">process</span><span class="p">)</span>

    <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">stim</span><span class="p">,</span> <span class="n">rw</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/arvoelke/anaconda3/envs/py36/lib/python3.6/site-packages/scipy/signal/filter_design.py:1551: BadCoefficients: Badly conditioned filter coefficients (numerator): the results may be meaningless
  &#34;results may be meaningless&#34;, BadCoefficients)
</pre></div></div>
</div>
</div>
<div class="section" id="2.-Decoding-functions-from-the-window">
<h2>2. Decoding functions from the window<a class="headerlink" href="#2.-Decoding-functions-from-the-window" title="Permalink to this headline">¶</a></h2>
<p>Next we use the <code class="docutils literal"><span class="pre">add_output(...)</span></code> method to decode functions from the state ensemble. This method takes a <code class="docutils literal"><span class="pre">t</span></code> argument specifying the relative time-points of interest, and a <code class="docutils literal"><span class="pre">function</span></code> argument that specifies the ideal function to be computed along this window of points. The method returns a node which approximates this function from the window of input history.</p>
<p>The <code class="docutils literal"><span class="pre">t</span></code> parameter can either be a single float, or an array of floats in the range <span class="math">\([0, 1]\)</span>. The size of <code class="docutils literal"><span class="pre">t</span></code> corresponds to the length of the window array <span class="math">\({\bf w}\)</span> passed to your function, and each element of the <code class="docutils literal"><span class="pre">t</span></code> array corresponds to the normalized delay in time for its respective point from the window. The <code class="docutils literal"><span class="pre">function</span></code> parameter must then accept a parameter <code class="docutils literal"><span class="pre">w</span></code> that is sized according to <code class="docutils literal"><span class="pre">t</span></code>, and should output the desired function from the given window <code class="docutils literal"><span class="pre">w</span></code>. Decoders
will be optimized to approximate this function from the state of the rolling window network.</p>
<p>For example:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">add_output(t=0,</span> <span class="pre">function=lambda</span> <span class="pre">w:</span> <span class="pre">w)</span></code> approximates a communication channel <span class="math">\(f(x(t)) = x(t)\)</span> (<em>Note</em>: this effectively undoes the filtering from the synapse!).</li>
<li><code class="docutils literal"><span class="pre">add_output(t=1,</span> <span class="pre">function=lambda</span> <span class="pre">w:</span> <span class="pre">w**2)</span></code> approximates the function <span class="math">\(f(x(t)) = x(t-\theta)^2\)</span>.</li>
<li><code class="docutils literal"><span class="pre">add_output(t=[.5,</span> <span class="pre">1],</span> <span class="pre">function=lambda</span> <span class="pre">w:</span> <span class="pre">w[1]</span> <span class="pre">-</span> <span class="pre">w[0])</span></code> approximates the function <span class="math">\(f(x(t)) = x(t-\theta) - x(t-\theta/2)\)</span>.</li>
</ul>
<p>By default, <code class="docutils literal"><span class="pre">t</span></code> will be <code class="docutils literal"><span class="pre">1000</span></code> points spaced evenly between <code class="docutils literal"><span class="pre">0</span></code> and <code class="docutils literal"><span class="pre">1</span></code>. For example:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">add_output(function=np.mean)</span></code> approximates the mean of this sampled window.</li>
<li><code class="docutils literal"><span class="pre">add_output(function=np.median)</span></code> approximates a <a class="reference external" href="https://en.wikipedia.org/wiki/Median_filter">median filter</a>.</li>
<li><code class="docutils literal"><span class="pre">add_output(function=np.max)</span></code> approximates the size of the largest peak.</li>
<li><code class="docutils literal"><span class="pre">add_output(function=lambda</span> <span class="pre">w:</span> <span class="pre">np.argmax(w)/float(len(w)))</span></code> approximates how long ago the largest peak occured.</li>
</ul>
<p>The function can also return multiple dimensions.</p>
<p>Here we compute two functions from the same state: (1) a delay of <span class="math">\(\theta\)</span> seconds, and (2) the first four <em>moments</em> of the window.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">delay</span> <span class="o">=</span> <span class="n">rw</span><span class="o">.</span><span class="n">output</span>  <span class="c1"># equivalent to: rw.add_output(t=1)</span>

    <span class="k">def</span> <span class="nf">compute_moments</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the first four moments of the window x.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>

    <span class="n">moments</span> <span class="o">=</span> <span class="n">rw</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="n">compute_moments</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="3.-Set-up-probes">
<h2>3. Set up probes<a class="headerlink" href="#3.-Set-up-probes" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">tau_probe</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># to filter the spikes</span>

<span class="k">with</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">p_stim_unfiltered</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">stim</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="n">p_stim</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">stim</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="n">tau_probe</span><span class="p">)</span>  <span class="c1"># filter for consistency</span>

    <span class="n">p_delay</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">delay</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="n">tau_probe</span><span class="p">)</span>

    <span class="n">p_moments</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">moments</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="n">tau_probe</span><span class="p">)</span>

    <span class="n">p_x</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">rw</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="n">tau_probe</span><span class="p">)</span>  <span class="c1"># for later analysis</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="4.-Simulate-the-network">
<h2>4. Simulate the network<a class="headerlink" href="#4.-Simulate-the-network" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/arvoelke/CTN/nengolib/nengolib/signal/system.py:718: UserWarning: Filtering with non-SISO systems is an experimental feature that may not behave as expected.
  &#34;expected.&#34;, UserWarning)
/home/arvoelke/CTN/nengolib/nengolib/signal/system.py:718: UserWarning: Filtering with non-SISO systems is an experimental feature that may not behave as expected.
  &#34;expected.&#34;, UserWarning)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<script>
    if (Jupyter.version.split(".")[0] < 5) {
        var pb = document.getElementById("82d869ab-c1f1-45ee-b96f-16dec1906131");
        var text = document.createTextNode(
            "HMTL progress bar requires Jupyter Notebook >= " +
            "5.0 or Jupyter Lab. Alternatively, you can use " +
            "TerminalProgressBar().");
        pb.parentNode.insertBefore(text, pb);
    }
</script>
<div id="82d869ab-c1f1-45ee-b96f-16dec1906131" style="
    width: 100%;
    border: 1px solid #cfcfcf;
    border-radius: 4px;
    text-align: center;
    position: relative;">
  <div class="pb-text" style="
      position: absolute;
      width: 100%;">
    0%
  </div>
  <div class="pb-fill" style="
      background-color: #bdd2e6;
      width: 0%;">
    <style type="text/css" scoped="scoped">
        @keyframes pb-fill-anim {
            0% { background-position: 0 0; }
            100% { background-position: 100px 0; }
        }
    </style>
    &nbsp;
  </div>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div></div>
<script type="text/javascript">
var element = document.currentScript.previousSibling.previousSibling;

              (function () {
                  var root = document.getElementById('82d869ab-c1f1-45ee-b96f-16dec1906131');
                  var text = root.getElementsByClassName('pb-text')[0];
                  var fill = root.getElementsByClassName('pb-fill')[0];

                  text.innerHTML = 'Build finished in 0:00:03.';

            fill.style.width = '100%';
            fill.style.animation = 'pb-fill-anim 2s linear infinite';
            fill.style.backgroundSize = '100px 100%';
            fill.style.backgroundImage = 'repeating-linear-gradient(' +
                '90deg, #bdd2e6, #edf2f8 40%, #bdd2e6 80%, #bdd2e6)';


                fill.style.animation = 'none';
                fill.style.backgroundImage = 'none';

              })();

</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<script>
    if (Jupyter.version.split(".")[0] < 5) {
        var pb = document.getElementById("85bd8124-1205-4c43-bf22-de97318a0a53");
        var text = document.createTextNode(
            "HMTL progress bar requires Jupyter Notebook >= " +
            "5.0 or Jupyter Lab. Alternatively, you can use " +
            "TerminalProgressBar().");
        pb.parentNode.insertBefore(text, pb);
    }
</script>
<div id="85bd8124-1205-4c43-bf22-de97318a0a53" style="
    width: 100%;
    border: 1px solid #cfcfcf;
    border-radius: 4px;
    text-align: center;
    position: relative;">
  <div class="pb-text" style="
      position: absolute;
      width: 100%;">
    0%
  </div>
  <div class="pb-fill" style="
      background-color: #bdd2e6;
      width: 0%;">
    <style type="text/css" scoped="scoped">
        @keyframes pb-fill-anim {
            0% { background-position: 0 0; }
            100% { background-position: 100px 0; }
        }
    </style>
    &nbsp;
  </div>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div></div>
<script type="text/javascript">
var element = document.currentScript.previousSibling.previousSibling;

              (function () {
                  var root = document.getElementById('85bd8124-1205-4c43-bf22-de97318a0a53');
                  var text = root.getElementsByClassName('pb-text')[0];
                  var fill = root.getElementsByClassName('pb-fill')[0];

                  text.innerHTML = 'Simulation finished in 0:00:01.';

            if (100.0 > 0.) {
                fill.style.transition = 'width 0.1s linear';
            } else {
                fill.style.transition = 'none';
            }

            fill.style.width = '100.0%';
            fill.style.animation = 'none';
            fill.style.backgroundImage = 'none'


                fill.style.animation = 'none';
                fill.style.backgroundImage = 'none';

              })();

</script></div>
</div>
</div>
<div class="section" id="5.-Plot-results">
<h2>5. Plot results<a class="headerlink" href="#5.-Plot-results" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="c1"># Compute the ideal for comparison</span>
<span class="n">ideal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_moments</span><span class="p">])</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rw</span><span class="o">.</span><span class="n">theta</span> <span class="o">/</span> <span class="n">rw</span><span class="o">.</span><span class="n">dt</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ideal</span><span class="p">)):</span>
    <span class="n">ideal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_moments</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_stim_unfiltered</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">nengolib</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="n">ideal</span> <span class="o">=</span> <span class="n">nengolib</span><span class="o">.</span><span class="n">Lowpass</span><span class="p">(</span><span class="n">tau_probe</span><span class="p">)</span><span class="o">.</span><span class="n">filt</span><span class="p">(</span><span class="n">ideal</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">rw</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Decoding a Delay&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_stim</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Input&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_delay</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Delay&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">p_moments</span><span class="o">.</span><span class="n">size_in</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_moments</span><span class="o">.</span><span class="n">size_in</span><span class="p">):</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">nengolib</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">nrmse</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_moments</span><span class="p">][:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">target</span><span class="o">=</span><span class="n">ideal</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mathbb</span><span class="si">{E}</span><span class="s2"> \left[{\bf w}^</span><span class="si">%d</span><span class="s2">\right]$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_moments</span><span class="p">][:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Actual (NRMSE=</span><span class="si">%.2f</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">error</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">ideal</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Expected&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.20</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_examples_rolling_window_12_0.png" src="../../_images/notebooks_examples_rolling_window_12_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_examples_rolling_window_12_1.png" src="../../_images/notebooks_examples_rolling_window_12_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;State Space&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_x</span><span class="p">])</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;${\bf x}$&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_examples_rolling_window_13_0.png" src="../../_images/notebooks_examples_rolling_window_13_0.png" />
</div>
</div>
</div>
<div class="section" id="Understanding-the-network">
<h2>Understanding the network<a class="headerlink" href="#Understanding-the-network" title="Permalink to this headline">¶</a></h2>
<p>This network essentially uses the <code class="docutils literal"><span class="pre">PadeDelay</span></code> system of order <span class="math">\(d\)</span> to compress the input into a <span class="math">\(d\)</span>-dimensional state <span class="math">\({\bf x}\)</span>. This state vector represents a rolling window of input history by a linear combination of <span class="math">\(d\)</span> basis functions:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">B_canonical</span> <span class="o">=</span> <span class="n">rw</span><span class="o">.</span><span class="n">canonical_basis</span><span class="p">()</span>

<span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Canonical Basis&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nengolib</span><span class="o">.</span><span class="n">networks</span><span class="o">.</span><span class="n">t_default</span><span class="p">,</span> <span class="n">B_canonical</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_examples_rolling_window_15_0.png" src="../../_images/notebooks_examples_rolling_window_15_0.png" />
</div>
</div>
<p>But since the state-space is transformed (by default it is a “balanced realization”), we have the following change of basis (by the linearly independent transformation <code class="docutils literal"><span class="pre">rw.realizer_result.T</span></code>):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">B</span> <span class="o">=</span> <span class="n">rw</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">B_canonical</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rw</span><span class="o">.</span><span class="n">realizer_result</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">B</span><span class="p">)</span>

<span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Realized Basis&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nengolib</span><span class="o">.</span><span class="n">networks</span><span class="o">.</span><span class="n">t_default</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_examples_rolling_window_17_0.png" src="../../_images/notebooks_examples_rolling_window_17_0.png" />
</div>
</div>
<p>Since the encoders of the network are axis-aligned (to improve accuracy of the linear system), this means that the function is able to accurately decode functions of the form:</p>
<div class="math">
\[f \left( \sum_{i=1}^d x_i {\bf u}_i \right) = \sum_{i=1}^{d} f_i ( x_i )\]</div>
<p>where <span class="math">\({\bf u}_i\)</span> is the <span class="math">\(i^\texttt{th}\)</span> basis function, <span class="math">\(x_i\)</span> is the corresponding weight given by the state vector <span class="math">\({\bf x}\)</span>, and each <span class="math">\(f_i\)</span> is some nonlinear function supported by the neural tuning curves (typically a low-order polynomial).</p>
<p>We now write <span class="math">\({\bf w} = B {\bf x} = \sum_{i=1}^d x_i {\bf u}_i\)</span> where <span class="math">\(B = \left[ {\bf u}_1 \ldots {\bf u}_d \right]\)</span> is our basis matrix, and <span class="math">\({\bf w}\)</span> is the window of history. Then the Moore-Penrose pseudoinverse <span class="math">\(B^+ = (B^T B)^{-1} B^T\)</span> gives us the relationship <span class="math">\({\bf x} = B^+ {\bf w}\)</span>, where <span class="math">\(B^+ = \left[ {\bf v}_1 \ldots {\bf v}_d \right]^T\)</span> and ${<span class="math">\bf v</span>}_i $ can be called the <span class="math">\(i^\texttt{th}\)</span> “inverse basis function”. Finally, we
can rewrite the computed function <span class="math">\(f\)</span> with respect to the window <span class="math">\({\bf w}\)</span> as:</p>
<div class="math">
\[f ( {\bf w} ) = \sum_{i=1}^{d} f_i ( {\bf v}_i  \cdot {\bf w} )\]</div>
<p>In other words, the functions that we can compute most accurately will be some linear combination of low-order nonlinearities applied to each <span class="math">\({\bf v}_i \cdot {\bf w}\)</span>. Below we visualize each of these inverse basis function:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Inverse Basis Functions&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nengolib</span><span class="o">.</span><span class="n">networks</span><span class="o">.</span><span class="n">t_default</span><span class="p">,</span> <span class="n">rw</span><span class="o">.</span><span class="n">inverse_basis</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_examples_rolling_window_19_0.png" src="../../_images/notebooks_examples_rolling_window_19_0.png" />
</div>
</div>
<p>Since the basis functions for the balanced realization are nearly orthogonal, the inverse basis functions are approximately a rescaled version of the former.</p>
</div>
<div class="section" id="Debugging-issues-in-performance">
<h2>Debugging issues in performance<a class="headerlink" href="#Debugging-issues-in-performance" title="Permalink to this headline">¶</a></h2>
<p>If the desired function is not accurate, then first look at the state-space to see if it is being represented correctly. If not (you might see erratic oscillations or saturation at large values), then there are a few specific things to try:</p>
<ol class="arabic simple">
<li>Pass a more representative training <code class="docutils literal"><span class="pre">process</span></code>:</li>
</ol>
<ul class="simple">
<li>Make sure it corresponds to a typical input stimuli</li>
<li>Make it aperiodic over a longer time interval (at least 10 seconds)</li>
<li>Make the process contain higher frequencies (to “activate” all of the dimensions), or decrease the <code class="docutils literal"><span class="pre">dimensions</span></code>, or increase <code class="docutils literal"><span class="pre">theta</span></code></li>
<li>Make the process contain lower frequencies (to put it within the range of the Padé approximants), or increase the <code class="docutils literal"><span class="pre">dimensions</span></code>, or decrease <code class="docutils literal"><span class="pre">theta</span></code></li>
</ul>
<ol class="arabic simple" start="2">
<li>Pass <code class="docutils literal"><span class="pre">process=None</span></code>, and then:</li>
</ol>
<ul class="simple">
<li>Set <code class="docutils literal"><span class="pre">encoders</span></code> to be axis-aligned (<code class="docutils literal"><span class="pre">nengo.dists.Choice(np.vstack([I,</span> <span class="pre">-I]))</span></code>)</li>
<li>Set <code class="docutils literal"><span class="pre">radii</span></code> to the absolute maximum values of each dimension (<code class="docutils literal"><span class="pre">np.max(np.abs(x),</span> <span class="pre">axis=0)</span></code>, after realization)</li>
<li>Set <code class="docutils literal"><span class="pre">eval_points=nengolib.stats.cube</span></code> or to some representative points in state-space (after radii+realization)</li>
</ul>
<ol class="arabic simple" start="3">
<li>Change the solver and/or regularization:</li>
</ol>
<ul class="simple">
<li>Pass <code class="docutils literal"><span class="pre">solver=nengo.solvers.LstsqL2(reg=1e-X)</span></code> with different X ranging between <code class="docutils literal"><span class="pre">1</span></code> and <code class="docutils literal"><span class="pre">4</span></code></li>
<li>Pass this to either <code class="docutils literal"><span class="pre">add_output</span></code> (to apply only to the decoded function), or to the constructor (to apply to both the recurrent function and the decoded function)</li>
</ul>
<p>Otherwise, if your function is not expressable as <span class="math">\(\sum_{i=1}^{d} f_i ( {\bf v}_i \cdot {\bf w} )\)</span> for the above <span class="math">\({\bf v}_i\)</span> and for low-order <span class="math">\(f_i\)</span>, try:</p>
<ol class="arabic simple">
<li>Pass a different state-space realization by providing a different <code class="docutils literal"><span class="pre">realizer</span></code> object to the <code class="docutils literal"><span class="pre">RollingWindow</span></code>. See <code class="docutils literal"><span class="pre">LinearNetwork</span></code> for details on realizers. This might rotate the state-space into the form of the above (analogous to how the nonlinear <code class="docutils literal"><span class="pre">Product</span></code> network is just a diagonal rotation of the linear <code class="docutils literal"><span class="pre">EnsembleArray</span></code>).</li>
<li>Create a second ensemble with uniformly distributed encoders (or some other non-orthogonal distribution) and communicate the state variable to that ensemble. Then decode the desired function from that second ensemble using the above basis matrix to define the function with respect to <code class="docutils literal"><span class="pre">x</span></code>.</li>
<li>For expert users, the <code class="docutils literal"><span class="pre">RollingWindow</span></code> is designed to be very “hackable”, in that you can specify many of the <code class="docutils literal"><span class="pre">Ensemble</span></code> and <code class="docutils literal"><span class="pre">Connection</span></code> parameters needed to tweak performance, or customize how the <code class="docutils literal"><span class="pre">process</span></code> is used to solve for the <code class="docutils literal"><span class="pre">eval_points</span></code> and <code class="docutils literal"><span class="pre">encoders</span></code>, or even subclass what happens in <code class="docutils literal"><span class="pre">_make_core</span></code>.</li>
</ol>
</div>
<div class="section" id="References">
<h2>References<a class="headerlink" href="#References" title="Permalink to this headline">¶</a></h2>
<p>[1] Aaron R. Voelker and Chris Eliasmith. Improving spiking dynamical networks: accurate delays, higher-order synapses, and time cells. Neural Computation, 30(3):569-609, 03 2018. <a class="reference external" href="https://www.mitpressjournals.org/doi/abs/10.1162/neco_a_01046">https://www.mitpressjournals.org/doi/abs/10.1162/neco_a_01046</a>, doi:10.1162/neco_a_01046. [<a class="reference external" href="https://github.com/arvoelke/delay2017">GitHub</a>]</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo.png" alt="Logo"/>
    
    <h1 class="logo logo-name">nengolib</h1>
    
  </a>
</p>



<p class="blurb">Tools for robust dynamics in Nengo.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=arvoelke&repo=nengolib&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/arvoelke/nengolib">
    <img
        alt="https://secure.travis-ci.org/arvoelke/nengolib.svg?branch=master"
        src="https://secure.travis-ci.org/arvoelke/nengolib.svg?branch=master"
    />
</a>
</p>




    

<p>
<a class="badge" href="https://codecov.io/github/arvoelke/nengolib">
    <img
    alt="https://codecov.io/github/arvoelke/nengolib/coverage.svg?branch=master"
    src="https://codecov.io/github/arvoelke/nengolib/coverage.svg?branch=master"
    />
</a>
</p>
<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../notebooks.html">Notebooks</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../notebooks.examples.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks.research.html">Research</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../success.html">Success stories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../../notebooks.html">Notebooks</a><ul>
  <li><a href="../../notebooks.examples.html">Examples</a><ul>
      <li>Previous: <a href="network.html" title="previous chapter">Network Improvements</a></li>
      <li>Next: <a href="../../notebooks.research.html" title="next chapter">Research</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017-2018, Aaron Voelker.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.7</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/notebooks/examples/rolling_window.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>