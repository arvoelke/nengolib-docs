
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>nengolib.synapses.ss2sim &#8212; nengolib 0.4.0-beta documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.4.0-beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="nengolib.synapses.BoxFilter" href="nengolib.synapses.BoxFilter.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="nengolib-synapses-ss2sim">
<h1>nengolib.synapses.ss2sim<a class="headerlink" href="#nengolib-synapses-ss2sim" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="nengolib.synapses.ss2sim">
<code class="descclassname">nengolib.synapses.</code><code class="descname">ss2sim</code><span class="sig-paren">(</span><em>sys</em>, <em>synapse</em>, <em>dt</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/arvoelke/nengolib/tree/v0.4.0-beta/nengolib/synapses\mapping.py#L10-L152"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nengolib.synapses.ss2sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps a linear system onto a synapse in state-space form.</p>
<p>This implements a generalization of Principle 3 from the Neural Engineering
Framework (NEF). <a class="footnote-reference" href="#id2" id="id1">[1]</a>
Intuitively, this routine compensates for the change in dynamics
that occurs when the integrator that usually forms the basis for any
linear system is replaced by the given synapse.
This is needed because in neural systems we don’t have access to a
perfect integrator; instead the synapse model becomes the
“dynamical primitive”.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>sys</strong> : <a class="reference internal" href="types.html#linear_system_like" title="linear_system_like"><code class="xref py py-data docutils literal"><span class="pre">linear_system_like</span></code></a></p>
<blockquote>
<div><p>Linear system representation of desired dynamical system.
Requires <code class="docutils literal"><span class="pre">sys.analog</span> <span class="pre">==</span> <span class="pre">synapse.analog</span></code>.</p>
</div></blockquote>
<p><strong>synapse</strong> : <a class="reference internal" href="types.html#linear_system_like" title="linear_system_like"><code class="xref py py-data docutils literal"><span class="pre">linear_system_like</span></code></a></p>
<blockquote>
<div><p>Linear system representation of the synapse providing the dynamics.
Requires <code class="docutils literal"><span class="pre">sys.analog</span> <span class="pre">==</span> <span class="pre">synapse.analog</span></code>.</p>
</div></blockquote>
<p><strong>dt</strong> : <code class="docutils literal"><span class="pre">float</span></code> or <code class="docutils literal"><span class="pre">None</span></code></p>
<blockquote>
<div><p>Time-step of simulation. If not <code class="docutils literal"><span class="pre">None</span></code>, then both <code class="docutils literal"><span class="pre">sys</span></code> and
<code class="docutils literal"><span class="pre">synapse</span></code> are discretized using the <code class="docutils literal"><span class="pre">'zoh'</span></code> method.
In either case, if <code class="docutils literal"><span class="pre">sys</span></code> is now digital, then the digital
generalization of Principle 3 will be applied — otherwise the analog
version will be applied.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a class="reference internal" href="nengolib.signal.LinearSystem.html#nengolib.signal.LinearSystem" title="nengolib.signal.LinearSystem"><code class="xref py py-class docutils literal"><span class="pre">LinearSystem</span></code></a></p>
<blockquote class="last">
<div><p>Linear system whose state-space matrices yield the desired
dynamics when using the synapse model instead of an integrator.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="nengolib.networks.LinearNetwork.html#nengolib.networks.LinearNetwork" title="nengolib.networks.LinearNetwork"><code class="xref py py-class docutils literal"><span class="pre">LinearNetwork</span></code></a>, <a class="reference internal" href="nengolib.signal.LinearSystem.html#nengolib.signal.LinearSystem" title="nengolib.signal.LinearSystem"><code class="xref py py-class docutils literal"><span class="pre">LinearSystem</span></code></a>, <a class="reference internal" href="nengolib.signal.cont2discrete.html#nengolib.signal.cont2discrete" title="nengolib.signal.cont2discrete"><code class="xref py py-func docutils literal"><span class="pre">cont2discrete()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>This routine is called automatically by <a class="reference internal" href="nengolib.networks.LinearNetwork.html#nengolib.networks.LinearNetwork" title="nengolib.networks.LinearNetwork"><code class="xref py py-class docutils literal"><span class="pre">LinearNetwork</span></code></a>.</p>
<p>Principle 3 is a special case of this routine when called with
a continuous <a class="reference internal" href="nengolib.synapses.Lowpass.html#nengolib.synapses.Lowpass" title="nengolib.synapses.Lowpass"><code class="xref py py-func docutils literal"><span class="pre">Lowpass()</span></code></a> synapse and <code class="docutils literal"><span class="pre">dt=None</span></code>. However, specifying
the <code class="docutils literal"><span class="pre">dt</span></code> (or providing digital systems) will improve the accuracy in
digital simulation.</p>
<p>For higher-order synapses, this makes a zero-order hold (ZOH) assumption
to avoid requiring the input derivatives. In this case, the mapping is
not perfect. If the input derivatives are known, then the accuracy can be
made perfect again. See references for details.</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>A. R. Voelker and C. Eliasmith, “Improving spiking dynamical
networks: Accurate delays, higher-order synapses, and time cells”,
2017, Submitted. [<a class="reference external" href="https://github.com/arvoelke/delay2017">URL</a>]</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>See <a class="reference internal" href="notebooks.research.discrete_comparison.html"><span class="doc">notebooks/research/discrete_comparison.ipynb</span></a> for a notebook example.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nengolib.synapses</span> <span class="k">import</span> <span class="n">ss2sim</span><span class="p">,</span> <span class="n">PadeDelay</span>
</pre></div>
</div>
<p>Map the state of a balanced <a class="reference internal" href="nengolib.synapses.PadeDelay.html#nengolib.synapses.PadeDelay" title="nengolib.synapses.PadeDelay"><code class="xref py py-func docutils literal"><span class="pre">PadeDelay()</span></code></a> onto a lowpass synapse:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nengo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nengolib.signal</span> <span class="k">import</span> <span class="n">balance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sys</span> <span class="o">=</span> <span class="n">balance</span><span class="p">(</span><span class="n">PadeDelay</span><span class="p">(</span><span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">synapse</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Lowpass</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mapped</span> <span class="o">=</span> <span class="n">ss2sim</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="n">synapse</span><span class="p">,</span> <span class="n">synapse</span><span class="o">.</span><span class="n">default_dt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="n">mapped</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="n">mapped</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>
</pre></div>
</div>
<p>Simulate the mapped system directly (without neurons):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">process</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">processes</span><span class="o">.</span><span class="n">WhiteSignal</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">stim</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">process</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">x</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">size_in</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">stim</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">mapped</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="n">synapse</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">mapped</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">synapse</span><span class="o">=</span><span class="n">synapse</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">p_stim</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">stim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">p_actual</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>The desired dynamics are implemented perfectly:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">filt</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_stim</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_actual</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">target</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">trange</span><span class="p">(),</span> <span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p_actual</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//nengolib-synapses-ss2sim-1.py">Source code</a>)</p>
<div class="figure">
<img alt="_images/nengolib-synapses-ss2sim-1.png" src="_images/nengolib-synapses-ss2sim-1.png" />
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/logo.png" alt="Logo"/>
    
    <h1 class="logo logo-name">nengolib</h1>
    
  </a>
</p>



<p class="blurb">Tools for robust dynamics in Nengo.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=arvoelke&repo=nengolib&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a href="https://travis-ci.org/arvoelke/nengolib">
    <img
        alt="https://secure.travis-ci.org/arvoelke/nengolib.svg?branch=master"
        src="https://secure.travis-ci.org/arvoelke/nengolib.svg?branch=master"
    />
</a>
</p>




    

<p>
<a href="https://codecov.io/github/arvoelke/nengolib">
    <img
    alt="https://codecov.io/github/arvoelke/nengolib/coverage.svg?branch=master"
    src="https://codecov.io/github/arvoelke/nengolib/coverage.svg?branch=master"
    />
</a>
</p>
<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Notebooks</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="reference.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="nengolib.html">Main (<code class="docutils literal"><span class="pre">nengolib</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="nengolib.networks.html">Networks (<code class="docutils literal"><span class="pre">nengolib.networks</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="nengolib.signal.html">Signal (<code class="docutils literal"><span class="pre">nengolib.signal</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="nengolib.stats.html">Stats (<code class="docutils literal"><span class="pre">nengolib.stats</span></code>)</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="nengolib.synapses.html">Synapses (<code class="docutils literal"><span class="pre">nengolib.synapses</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="success.html">Success stories</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="reference.html">Reference</a><ul>
  <li><a href="nengolib.synapses.html">Synapses (<code class="docutils literal"><span class="pre">nengolib.synapses</span></code>)</a><ul>
      <li>Previous: <a href="nengolib.synapses.BoxFilter.html" title="previous chapter">nengolib.synapses.BoxFilter</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Aaron Voelker.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/nengolib.synapses.ss2sim.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>